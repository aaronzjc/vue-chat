## 开发中...

重要|遗留的问题

### 2016.08.14

* ~~Websocket刷新页面连接断开~~

> 解决方法是，每个路由，除了登录。都去校验是否断开，如果是断开的情况，则重新连接。不在连接断开的函数中处理。

* ~~获取历史消息记录~~

> 获取数据，更新组件数据。同步更新全局的聊天记录。

* ~~组件异步加载数据，不同步的问题~~

> 我是这么处理，遇到这个问题的。底部的工具栏是全局组件。提示有多少未读消息，是通过一个全局变量来维护的。第一次登陆上来，异步获取数据。然后，在回调里面更新这个全局变量。发现，不成功。原因是，等数据回来时，组件渲染完了。所以，这里的处理是，在异步里面发送一个消息给子组件。通知更新未读消息数。

### 2016.08.15

* ~~数据缓存。为了处理用户体验，缓存太多。~~

> 之前觉得不太妥当，因为有缓存的地方，取数据总是很不优雅。和APP端讨论了一下，发现大抵如此。

### 2016.08.16

* ~~下拉刷新~~

> 下拉刷新这里，折腾了一会，但是也解决了。好说。

* 优化各个地方的请求

### 2016.08.17

* ~~完善一些流程，例如，注册等~~
* ~~动画动画动画，增加一点转场动画~~

> 动画这里，有个小问题，vue-router完整支持transition模式。但是要求vue-router的路由组件不能是[片段实例](https://vuejs.org.cn/guide/components.html#片断实例)。

* ~~图片上传，因为没找到好的方式呈现，所以就没做~~

> 1. 上传按钮美化。隐藏掉默认，然后，设置容器样式。
> 2. 上传图片，使用浏览器FileReader类，将图片转化为Base64然后，服务器解码储存。
> 3. 文件上传，路径问题麻烦。

* ~~底层架构更改想法~~

> 我做的这个应用本质上，算是实时应用。涉及聊天等。从公司的架构思想，和其他人的例子看，是所有的请求走的socket。而不是像我这样，夹杂HTTP请求和Socket两者。所以，后期可能改进，所有的数据全部走Websocket连接。

### 2016.08.18

* ~~将AppBar提升至全局模板~~

> 将Bar提升至全局了。好处是，页面切换时，bar不刷新，并且，也应该是全局的。

### 2016.08.19

* ~~消息已读，未读，消息数提示bug修正~~

> __问题__
>
> 因为使用全局的变量存储的。所以，这一块一直很诡异。这里，我觉得需要学习一下vuex，改进改进。最后并没有用到Vuex。倒是学习了一下。
>
> __解决__
>
> 首先，思路是很正确的。在Websocket中，并不能直接和组件进行通信。解决方案是，设置一个全局的JS变量，然后，组件读取这个变量，ws更新该变量。
>
> 这里，这个思路是正确的。问题是，组建的数据绑定到全局变量上的问题。这里应用了JS的应用传值。如果全局变量是基础数据类型，这里是无法绑定的，因为JS是按值传递，所以绑定时，是副本。即使全局更新了，也不会响应。所以，切记绑定到全局对象上。

### 2016.08.20

* ~~更新代码为ES6语法~~

> 更新ES6主要是，利用箭头函数的特性，处理回调函数的this问题。

### 2016.08.22

* 后端架构更改想法2⃣️

> 其实本来就不应该有HTTP接口这一层。所有的业务请求，都是走Socket，后端处理。

### 2016.08.233

* 好多bug修复

> 实际上线之后，聊天功能还是OK的~但是有好多BUG。所以接下来，优先修复bug和影响体验的地方。
>
> __BUGS__
>
> * 图片404默认
> * 同名用户
> * 修改个人资料有问题
> * 好友关系问题
>
> 上线。都修改了。接下来，主要是优化体验。

### 2016.08.25

* ~~聊天列表显示最新一条消息~~
* ~~聊天的Title显示聊天的用户昵称~~
* ~~用户签名~~
* ~~聊天列表下拉刷新，获取数据错误的BUG。~~
* 点击输入框，聊天时，消息面板自动滚动到最上面。
